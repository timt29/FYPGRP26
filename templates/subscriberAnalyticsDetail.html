<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Analytics — {{ article.title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="{{ url_for('static', filename='img/favicon.png') }}" type="image/png" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/subscriber.css') }}">
</head>
<body>

  <!-- Top Bar -->
  <header class="topbar">
    <div class="left">
      <a href="{{ url_for('subscriberHomepage') }}" class="brand">
        <img src="{{ url_for('static', filename='img/echopresslogo.png') }}" alt="EchoPress">
      </a>
      <div class="search">
        <input type="text" placeholder="Searching for… ?" aria-label="Search">
        <button>Search</button>
      </div>
    </div>

    <div class="right">
      <span class="welcome">Welcome, {{ session.get('user','Subscriber') }} !</span>
      <button id="menuBtn" class="burger" aria-label="Menu"><span></span><span></span><span></span></button>
      <div id="menuPanel" class="menu-panel">
        <a href="{{ url_for('bookmarks') }}">View Bookmarks</a>
        <a href="{{ url_for('my_articles') }}">View My Articles</a>
        <a href="{{ url_for('analytics') }}">View Analytics</a>
        <a href="/profile">Edit Profile</a>
        <a href="#" class="logout-link logout">Log Out</a>
      </div>
    </div>
  </header>

  <!-- Tabs row (optional for visual consistency) -->
  <nav class="tabs">
    <div class="tabs-inner">
      <a href="#" class="tab">For you</a>
      <a href="#" class="tab active">Trending</a>
      <a href="#" class="tab">Politics</a>
      <a href="#" class="tab">Sports</a>
      <a href="#" class="tab">Technology</a>
      <a href="#" class="tab">Economic</a>
      <a href="#" class="tab">AsiaNews</a>
      <a href="#" class="tab">WorldNews</a>
    </div>
  </nav>

  <!-- Page -->
  <main class="page">
    <!-- LEFT -->
    <section class="feed">

      <!-- Title + Tiles -->
      <div class="article-card detail">
        <div class="card-header">
          Analytics of {{ article.title }}
        </div>

        <div class="stats-grid" style="margin-top:8px;">
          <div class="stat-box">
            <div class="stat-num">{{ stats.views }}</div>
            <div class="stat-label">Views</div>
          </div>
          <div class="stat-box">
            <div class="stat-num">{{ stats.likes }}</div>
            <div class="stat-label">Likes</div>
          </div>
          <div class="stat-box">
            <div class="stat-num">{{ stats.dislikes }}</div>
            <div class="stat-label">Dislikes</div>
          </div>
          <div class="stat-box">
            <div class="stat-num">{{ stats.shares }}</div>
            <div class="stat-label">Share</div>
          </div>
        </div>
      </div>

      <!-- Comments table -->
      <div class="article-card detail" style="margin-top:16px;">
        <div class="card-header" style="margin-bottom:8px;">Comments</div>
        {% if not comments %}
          <p>No comments yet.</p>
        {% else %}
          <div class="table-wrap">
            <table class="table">
              <thead>
                <tr><th style="width:220px;">User</th><th>Comments</th></tr>
              </thead>
              <tbody>
                {% for c in comments %}
                  <tr>
                    <td class="user">{{ c.user }}</td>
                    <td class="comment">{{ c.text }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% endif %}
      </div>

    </section>

    <!-- RIGHT: Ads column -->
    <aside class="sidebar">
      <div class="ads">Ads</div>
    </aside>
  </main>

  <!-- Logout Confirmation Modal -->
  <div id="logoutModal" class="modal-overlay">
    <div class="modal">
      <h2>Log Out?</h2>
      <div class="buttons">
        <button class="yes" id="confirmLogout">Yes</button>
        <button class="no" id="cancelLogout">No</button>
      </div>
    </div>
  </div>

  <!-- JS: menu + logout modal -->
  <script>
    (function () {
      const btn = document.getElementById('menuBtn');
      const panel = document.getElementById('menuPanel');
      function closeP(){ panel.style.display='none'; }
      function toggleP(){ panel.style.display = panel.style.display==='block' ? 'none' : 'block'; }
      btn.addEventListener('click', e=>{ e.stopPropagation(); toggleP(); });
      document.addEventListener('click', e=>{ if(panel && !panel.contains(e.target) && e.target!==btn) closeP(); });
      document.addEventListener('keydown', e=>{ if(e.key==='Escape') closeP(); });

      const modal = document.getElementById("logoutModal");
      document.querySelectorAll(".logout-link").forEach(link=>{
        link.addEventListener("click", e => { e.preventDefault(); modal.style.display="flex"; });
      });
      document.getElementById("confirmLogout").addEventListener("click", ()=>{ window.location.href="{{ url_for('logout') }}"; });
      document.getElementById("cancelLogout").addEventListener("click", ()=>{ modal.style.display="none"; });
      document.addEventListener("keydown", e => { if(e.key==="Escape") modal.style.display="none"; });
    })();
  </script>
</body>
</html>
