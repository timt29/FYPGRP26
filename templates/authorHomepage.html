<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>EchoPress â€” Author Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="{{ url_for('static', filename='img/favicon.png') }}" type="image/png" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/author.css') }}">
</head>
<body>

  <!-- Top Bar (black) -->
  <header class="topbar">
    <div class="left">
      <a class="brand" href="{{ url_for('authorHomepage') }}">
        <img src="{{ url_for('static', filename='img/echopresslogo.png') }}" alt="EchoPress" />
        <span class="brand-text">EchoPress</span>
      </a>
      <form class="search"><input type="text" placeholder="Searching forâ€¦ ?"></form>
    </div>
    <div class="right">
      <span class="welcome">Welcome, {{ session.get('user', 'Author') }} !</span>
      <button id="menuBtn" class="burger" aria-label="Menu"><span></span><span></span><span></span></button>
      <div id="menuPanel" class="menu-panel">
        <a href="{{ url_for('authorHomepage') }}" class="active">Author Home</a>
        <a href="{{ url_for('my_articles') }}">My Articles</a>
        <a href="{{ url_for('analytics') }}">View Analytics</a>
        <a href="{{ url_for('profile') }}">Profile</a>
        <a href="#" class="logout-link">Log Out</a>
      </div>
    </div>
  </header>

  <!-- Tabs -->
  <nav class="tabs">
    <div class="tabs-inner">
      <a href="#" class="tab">For you</a>
      <a href="#" class="tab active">Trending</a>
      <a href="#" class="tab">Politics</a>
      <a href="#" class="tab">Sports</a>
      <a href="#" class="tab">Technology</a>
      <a href="#" class="tab">Economic</a>
      <a href="#" class="tab">AsiaNews</a>
      <a href="#" class="tab">WorldNews</a>
    </div>
  </nav>

  <!-- Main -->
  <main class="page">
    <section class="feed">
      {% for a in default_articles[:4] %}
      <article class="article-card">
        <div class="text">
          {% if a.pinned %}
            <span class="pin-badge" title="This article is pinned">ðŸ“Œ Pinned</span>
          {% endif %}

          {% if loop.first %}
            <h2 class="card-title"><a href="{{ a.link }}" class="card-link">{{ a.title }}</a></h2>
          {% else %}
            <h3 class="card-title"><a href="{{ a.link }}" class="card-link">{{ a.title }}</a></h3>
          {% endif %}
          <p class="card-excerpt">{{ a.excerpt }}</p>
        </div>
        <a class="thumb-wrap" href="{{ a.link }}">
          <img class="thumb" src="{{ a.image_url }}" alt="">
        </a>
      </article>
      {% endfor %}
    </section>

    <aside class="sidebar">
      <a href="{{ url_for('create_edit_delete_article') }}" class="btn btn-primary wide">Create Your Story</a>
      <div class="ads">Ads</div>
    </aside>
  </main>

  <!-- Logout modal -->
  <div id="logoutModal" class="modal-overlay">
    <div class="modal"><h2>Log Out?</h2><div class="buttons"><button class="yes" id="confirmLogout">Yes</button><button class="no" id="cancelLogout">No</button></div></div>
  </div>

  <script>
    (function(){
      const btn=document.getElementById('menuBtn'), panel=document.getElementById('menuPanel');
      if(btn&&panel){const close=()=>panel.style.display='none', toggle=()=>panel.style.display=panel.style.display==='block'?'none':'block';
        btn.addEventListener('click',e=>{e.stopPropagation();toggle()});
        document.addEventListener('click',e=>{if(!panel.contains(e.target)&&e.target!==btn)close()});
        document.addEventListener('keydown',e=>{if(e.key==='Escape')close()});
      }
      const modal=document.getElementById("logoutModal"), ok=document.getElementById("confirmLogout"), no=document.getElementById("cancelLogout");
      document.querySelectorAll(".logout-link").forEach(l=>l.addEventListener("click",e=>{e.preventDefault();modal.style.display="flex"}));
      ok&&ok.addEventListener("click",()=>{window.location.href="{{ url_for('logout') }}"});
      no&&no.addEventListener("click",()=>{modal.style.display="none"});
      document.addEventListener("keydown",e=>{if(e.key==="Escape")modal.style.display="none"});
    })();
  </script>
</body>
</html>
